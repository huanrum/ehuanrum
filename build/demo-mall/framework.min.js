!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.ehr=e.$ehr=t()}(this,function(e){"use strict";function t(e,n){if("string"!=typeof(e=e||""))return void("function"==typeof e&&window?(window.addEventListener("load",e),"function"==typeof n&&window.addEventListener("beforeunload",n)):"boolean"==typeof e?l.binding=e:"number"==typeof e?l.version=e:u(e,n));if(e=e.trim().replace(/_/g,"."),">"===e[0])return l.temp[e.slice(1)];if(!n){if(!Object.getOwnPropertyNames(l.data).length){var r=l.temp;l.temp={},Object.keys(r).sort(function(e,t){return e.length-t.length}).forEach(function(e){l.temp[e]=r[e]})}if(!e)return l.data;if(l.temp[e]){var o,i=e.split("."),a=i.pop(),c=l.data;for(n=l.temp[e];i.length;)o=i.shift(),c=c[o]=c[o]||{};if(!c[a]&&n)if("function"==typeof n||n instanceof Array&&"function"==typeof n[n.length-1]){var f=[];if("function"==typeof n){var p=n.toLocaleString().slice(n.toLocaleString().indexOf("(")+1,n.toLocaleString().indexOf(")"));f=p?p.split(","):[]}else{var s=n.pop();f=n,n=s}for(var d=0;d<f.length;d++)"self"===f[d].trim().toLocaleLowerCase()?f[d]=l.data[e.split(".")[0]]:f[d]=t(f[d].trim());c[a]=n.apply(n,f)}else c[a]=n}for(var v in l.temp)v!==e&&function(e,t){for(var n=0;n<t.length;n++)if(e[n]!==t[n])return!1;return!0}(v.split("."),e.split("."))&&t(v);for(var m=e.split("."),y=l.data;m.length>1;)y=y[m.shift()];return y[m.shift()]}if("."===e[e.length-1]){var h=n;e=e.slice(0,e.length-1),n=function(){return h}}l.temp[e]=n}function n(e){return e=e.replace(/\$\S*\$/,""),e.split(/\s+/).map(function(e){return e[0].toLocaleUpperCase()+e.slice(1)}).join("")}function r(e){var t=[];return function(n){if("function"==typeof n&&1===arguments.length)t.push(n);else{var r=arguments;t.forEach(function(t){t.apply(e,r)})}}}function o(e,n,r,i){function a(e,n,r){return t("menuAction")?function(){t("menuAction")(r,e,n)}:(n.style.display=new RegExp("#"+(i||"")+"/"+r).test(location.hash)?"block":"none",function(){Array.prototype.forEach.call(this.parentNode.parentNode.children,function(e){Array.prototype.forEach.call(e.getElementsByTagName("UL"),function(e){e.style.display="none"})}),n.style.display="none"===n.style.display?"block":"none"})}function c(e,o,i){var a=document.createElement("span");return a.innerHTML=t("filter")(e),t("filter.menu")&&(a.innerHTML=t("filter.menu")(a.innerHTML,e)),a.addEventListener("click",function(){location.hash!=="#"+i&&(location.hash="#"+i,r(i,e))}),n[i]=o,a}var u=document.createElement("ul");return Object.keys(e).forEach(function(t){var f=document.createElement("div"),l=c(t,e[t],(i||"")+"/"+t.replace(/\$\S*\$/,""));if(u.appendChild(f),f.appendChild(l),Object.keys(e).length){var p=o(e[t],n,r,(i||"")+"/"+t.replace(/\$\S*\$/,""));f.appendChild(p),l.addEventListener("click",a(l,p,t.replace(/\$\S*\$/,"")))}}),u}function i(e,t){if(t in e)for(;e;){if(Object.getOwnPropertyDescriptor(e,t))return Object.getOwnPropertyDescriptor(e,t);e=e.__proto__}return{enumerable:!0}}function a(e,t,n){function r(e,t){var r=i(e,t);Object.defineProperty(e,t,{configurable:!0,enumerable:r.enumerable,set:function(e){r.set?r.set(e):r.value=e,n()},get:function(){return r.get&&r.get()||r.value}})}t.replace(/\'((?!\').)*\'/g,"").split(/[+\-*\/%\|\&\(\)=\?\:,!><]/).filter(function(e){return!!e.trim()}).forEach(function(t){/\[.*\]/.test(t)&&t.match(/\[[0-9a-zA-Z\.]*\]/g).forEach(function(n){t=t.replace(n,"."+c(e,n.replace(/[\[\]]/g,"")))});var n=e;t.split(".").forEach(function(e){r(n,e),n=n[e]||{}})}),setTimeout(function(){n()},500)}function c(t,n,r){function o(e,t,n){t=t||"";var r=t.trim().split(".");if(e){if(e instanceof HTMLElement&&!r[0]in e&&e.hasAttribute(r[0])){var a=e.attributes[r[0]];return r[0]="value",o(a,r.join("."),n)}if(t instanceof Array){for(var c=0;c<t.length;c++)if("number"==typeof e[t[c]]||e[t[c]])return e[t[c]];return"object"!=typeof e?e:null}for(;r.length>1;)r[0].trim()?e=i(e,r.shift(),!0):r.shift();if(void 0===n)return i(e,r.shift(),!1);i(e,r.shift(),!0,n)}}function i(e,t,n,r){if(/\[\d+\]/.test(t)){var o=t.replace(/\[\d+\]/g,"");o&&(e=e[o]=e[o]||[]),Array.prototype.map.call(t.match(/\[\d+\]/g),function(t,o,i){if(t=t.replace("[","").replace("]",""),o<i.length-1)e=e[t]=e[t]||[];else{if(!n)return e[t];e=e[t]=void 0!==r?r:e[t]||{}}})}else{if(!n)return e[t];void 0===r?e[t]||(e[t]={}):e[t]=r,e=e[t]}return e}return/^[0-9a-zA-Z\._$@]*$/.test(n)?o(t,n,r):e(t,n,o)}function u(e,n,o,p){function s(e,t,n){var r=n,o=n;return n instanceof Array||(r=Object.keys(n),o=Object.values(n)),o.forEach(function(n,o){var i=r[o],a=c(e,i);Object.defineProperty(e,i,{configurable:!0,enumerable:!0,set:function(e){c(t,n,e)},get:function(){return c(t,n)}}),Object.defineProperty(t,n,{configurable:!0,enumerable:!0,set:function(e){a=e},get:function(){return a}})}),t}function d(e){var r=t("control");Array.prototype.filter.call(e.attributes||[],function(e){return/^\[.+\]$/.test(e.name)}).sort(function(e,t){return/:/.test(t.name)-/:/.test(e.name)}).forEach(function(t){!/:/.test(t.name)&&c(r,t.name.slice(1,-1))&&e.parentNode?c(r,t.name.slice(1,-1).replace(/[_\-]/g,".")).call({defineProperty:a},e,n,t.value):f(e,n,y(t.name.slice(1,-1)),t.value),l.binding||e.removeAttribute(t.name)}),e.parentNode&&v.apply(e,e.children)}function v(){Array.prototype.forEach.call(arguments,function(e){e.scope?e.scope()!==n&&n!==window&&(e.scope().__proto__=n,n.$eval(e.scope().$eval)):u(e,n)})}function m(e,t){function n(e,n,r){n?r?r.before?r.before(e):n.insertBefore&&n.insertBefore(e,r):n.appendChild(e):e.parentNode&&(e.parentNode.removeChild(e),t.$destroy())}e.scope=function(){return t},e.update=function(t,r){e instanceof Array?e.forEach(function(e){n(e,t,r)}):n(e,t,r)}}function y(e){var t={class:"className",fontsize:"fontSize",innerhtml:"innerHTML"};Object.keys(t);return Object.keys(t).forEach(function(n){e=e.replace(n,t[n])}),e}if("string"==typeof o?(l.content.innerHTML="",location.hash="#"+o.replace(/\./g,"/"),o=null):"function"==typeof o&&(p=o,o=null),"string"==typeof e[0]&&"object"==typeof e[1]&&(Object.keys(e[1]).forEach(function(t){e[0]=e[0].replace(new RegExp("\\{\\s*"+t+"\\s*\\}","g"),e[1][t]||"")}),e=e[0]),"string"==typeof e&&(e=function(e){var t=document.createElement("div");return t.innerHTML=e,Array.prototype.slice.call(t.children,0)}(e),e.forEach(function(e){(o||l.content).appendChild(e)})),!(e instanceof Array||e instanceof HTMLElement))throw new Error("element必须是DOM元素。");return"function"==typeof n&&(p=n,n={}),function(){if(!n.$eval||n.$eval===n.__proto__.$eval){if(Object.defineProperty(n,"$id",{value:++l.binding$id}),Object.defineProperty(n,"$destroy",{value:r(n)}),Object.defineProperty(n,"$eval",{value:r(n)}),Object.defineProperty(n,"$real",{value:function(){return JSON.parse(JSON.stringify(n)||"null")}}),Object.defineProperty(n,"$extend",{value:function(e,t){return s(n,e,t)}}),p&&p(n,e),n===window)return;Object.keys(n).filter(function(e){return"function"!=typeof n[e]&&!(n[e]instanceof Node)}).forEach(function(e){var t=n[e],r=i(n,e)||{};Object.defineProperty(n,e,{configurable:!0,enumerable:r.enumerable,set:function(e){t=e,r.set&&r.set(e),n.$eval()},get:function(){var e=r.get&&r.get();return"number"==typeof e?e:e||t}})})}}(),m(e,n),e instanceof Array?e.forEach(function(e){m(e,n),d(e)}):d(e),n.$eval(),e}function f(e,n,r,o){function f(){var i=/\|\s*[0-9a-zA-Z_$@]+\s*\(?\S*\)?/g,a=c(n,o.replace(i,""));o.match(i)&&o.match(i).forEach(function(e){var r=t("filter."+e.split("(")[0].replace("|","").trim());if(r)if(e.split(/[\(\)]/g)[1]){var o=e.split(/[\(\)]/g)[1].split(",").map(function(e){return c(n,e.trim())});a=r.apply(t("filter"),[a].concat(o))}else a=r(a)}),c(e,r,a)}e.parentNode&&(/^\s*on/.test(r)?function(){function t(t){n.$event=t||window.event,n.$element=e;var r=c(n,o);return delete n.$event,delete n.$element,r}if("onload"===r){var i=t();/^[0-9a-zA-Z\._$@]*$/.test(o)&&i&&i.call(n,e)}else e.addEventListener(r.replace("on","").trim(),function(e){var r=t(e);/^[0-9a-zA-Z\._$@]*$/.test(o)&&r&&r.apply(n,arguments)})}():/\S+:\S+/.test(r)?function(t){function a(e){function r(e,t){return"length"in e?Array.prototype.map.call(e,t):e&&"object"==typeof e?Array.prototype.map.call(Object.keys(e),function(n){return t(e[n],n,e)}):[]}f.forEach(function(t){e.some(function(e){return t.t===e})||t.e.update()}),f=r(e||[],function(o,i){var a=(f.filter(function(e){return e.t===o})[0]||{}).e;if(a)a.scope().$eval();else{var s={$index:i};"number"==typeof i&&Object.defineProperty(s,"$index",{enumerable:!1,get:function(){return r(c(n,t[1])||[],function(e){return""+e}).indexOf(""+o)}}),Object.defineProperty(s,t[0],{configurable:!0,enumerable:!0,get:function(){return e[i]},set:function(t){e[i]=t}}),s.__proto__=n,a=u(d,s),n.$eval(s.$eval)}return a.update(p,l),{t:o,e:a}})}var f=[],l=e.nextSibling,p=e.parentNode,s=i(n,o||t[1]),d=e.outerHTML.replace("["+r+']="'+o+'"',"");e.parentNode.removeChild(e),s.value=s.value||[],Object.defineProperty(n,t[1],{configurable:!0,enumerable:s.enumerable,get:function(){return s.get&&s.get()||s.value},set:function(e){s.set?s.set(e):s.value=e,a(e)}}),a(c(n,o||t[1]))}(r.split(":")):/^[0-9a-zA-Z\._$@]*$/.test(o)?"function"==typeof c(n,o)?c(e,r,c(n,o)):function(){var t=o.split("."),a=t.pop(),u=i(t.length?c(n,t.join(".")):n,a);n.$eval(function(){c(e,r,c(n,o))}),Object.defineProperty(t.length?c(n,t.join(".")):n,a,{configurable:!0,enumerable:u.enumerable,set:function(t){c(e,r,t),u.set?u.set(t):u.writable&&(u.value=t)},get:function(){return"value"===r&&e.value||u.get&&u.get()||u.value}}),"value"===r?e.addEventListener("keyup",function(){c(n,o,c(e,r)),n.$eval()}):e.addEventListener("click",function(t){["INPUT","SELECT","TEXTAREA"].indexOf(t.target.nodeName)===-1&&c(n,o,c(e,r)),t.target.focus()})}():(a(n,o,f),n.$eval(f)))}var l={temp:{},data:{},load:[],binding$id:0};return window&&(l.menu=document.createElement("div"),l.content=document.createElement("div"),l.menu.className="ehuanrum-menu",l.content.className="ehuanrum-content",window.addEventListener("load",function(){function e(){t("router")?(document.body.appendChild(l.menu),document.body.appendChild(l.content),n("/"+a.filter(function(e){return!!e}).join("/"),a.pop()||a.pop())):document.body.appendChild(l.content)}function n(e){"string"==typeof e?(arguments[0]=r[e.replace(/^\s*router\./,"/")],n.apply(this,arguments)):"function"==typeof e?(l.content.innerHTML="",i&&i.scope()&&i.scope().$destroy(),i=e.apply(this,Array.prototype.slice.call(arguments,1))):e||(l.content.innerHTML='<div style="position: absolute;top:10em;left:50%;">没有对应的页面,请确认输入的地址！</div>')}var r={},i=null,a=location.hash.replace("#","").split("/");u(document.body,window),l.menu.appendChild(o(t("router")||{},r,n,"")),t("main")?t("main")(e):e()})),t("filter",function(){return n}),t("binding",function(){return u}),t("value",function(){return c}),function(){return t}}(function(_obj,_str,_valuer){with(_obj)return eval(_str)})),function(e){"use strict";e("functions.color",function(){return function(e){if(e)return"number"!=typeof e&&(e=0,Array.prototype.forEach.call(""+e,function(t){e+=t.charCodeAt()})),"#"+new Date(1e4).setYear(e).toString(16).slice(-8,-2);for(var t=Math.floor(256*Math.random()*256*256).toString(16).slice(-6);t.length<6;)t=0+t;return"#"+t}}),e("functions.event",function(){return function(e){function t(e){return n.push(e),t}var n=[];return Object.create({in:t,out:function(e){e&&(n=n.filter(function(t){return"function"==typeof e&&t!==e||"string"==typeof e&&t.name!==e}))},fire:function(){var t=arguments;n.forEach(function(n){n.apply(e,t)})}})}})}(window.$ehr),function(e){"use strict";e("random",function(){function e(o,i,a){if(a="function"==typeof a?a:t(),i)return n(""+i,function(t){var n=[];a(o);for(var r=0;r<t;r++)n.push(e(o,null,a));return n});if("string"==typeof o)return r(o,a);var c={};return Object.keys(o).forEach(function(t){var n=t.match(/:.*/);c[e(t.replace(n&&n[0],""),null,a)]=e(o[t],n&&n[0].replace(":","").trim(),a)}),c}function t(){var e=null,t={};return function(n){if(/^\d*\+\d*/.test(n))return t[e]=t[e]||(+n.split("+")[0]||1)-(+n.split("+")[1]||1),t[e]=t[e]+(+n.split("+")[1]||1),t[e];e=JSON.stringify(n)}}function n(e,t){return t=t||function(e){return e},e=e&&e.trim()||"1-100",e=e.split("-"),e[1]=e[1]||e[0],e=(Array(e[1].length).join("0")+Math.floor(+e[0]+Math.random()*(e[1]-e[0]))).slice(-e[1].length),t(e)}function r(e,t){function r(e){return/\-/.test(e)?n(e):/\+/.test(e)?t(e):o(e)||e}var a=e.match(/\[((?!\[).)*\]/g);return a&&a.forEach(function(t){if(/[\(\)\{\}]/.test(t)){var o=t.replace(/[\[\]]/g,"").split(/[\(\)\{\}]/);e=e.replace(t,n(o[3]||o[2],function(e){for(var t="",n=0;n<e;n++)t+=i(o[1]||"0-Z");return t}))}else{var a=t.replace(/[\[\]]/g,"").split(",").map(r);e=e.replace(t,a[Math.floor(Math.random()*a.length)])}}),e}function o(e){return{date:new Date,host:location.host}[e.toLocaleLowerCase()]}function i(e){for(;/\-/.test(e);){var t=e[e.indexOf("-")-1]||"",n=e[e.indexOf("-")+1]||"";e=e.replace(t+"-"+n,a.slice(a.indexOf(t||a[0]),a.indexOf(n||a[a.length-1])))}return e[Math.floor(Math.random()*e.length)]}var a="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";return e})}(window.$ehr);